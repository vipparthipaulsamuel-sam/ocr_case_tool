{% extends "base.html" %}
{% block content %}
<h3>Your Cases</h3>
<div class="row">
  <div class="col-md-6">
    <form method="post" action="{{ url_for('create_case') }}">
      <div class="mb-3">
        <label class="form-label">Case Name</label>
        <input type="text" name="name" class="form-control" placeholder="e.g., FIR-2025-08-23-XYZ" required>
      </div>
      <div class="mb-3">
        <label class="form-label">Description (optional)</label>
        <textarea name="description" class="form-control" rows="2"></textarea>
      </div>
      <button class="btn btn-success">Create Case</button>
    </form>
  </div>
</div>

<hr class="my-3"/>

<div class="table-responsive">
  <table class="table table-striped">
    <thead>
      <tr>
        <th>Case</th>
        <th>Owner</th>
        <th>Created</th>
        <th style="width: 220px;">Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for c in cases %}
      <tr>
        <td>{{ c.name }}</td>
        <td>{{ c.owner.name }} ({{ c.owner.email }})</td>
        <td>{{ c.created_at.strftime("%Y-%m-%d %H:%M") }}</td>
        <td>
          <a class="btn btn-sm btn-primary" href="{{ url_for('case_detail', case_id=c.id) }}">Open</a>
          <a class="btn btn-sm btn-outline-secondary ms-2" href="{{ url_for('payments.export_pdf_case', case_id=c.id) }}">Export as PDF</a>
        </td>
      </tr>
      {% else %}
      <tr><td colspan="4" class="text-muted">No cases yet.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
